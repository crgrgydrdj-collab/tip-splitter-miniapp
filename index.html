<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tip Splitter</title>

  <!-- Telegram Mini Apps (–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω, –Ω–æ –ø–æ–ª–µ–∑–µ–Ω) -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <style>
    :root{
      --bg:#0f0f13;
      --card:#1b1c22;
      --card2:#20212a;
      --text:#f2f2f6;
      --muted:#a8a8b3;
      --accent:#5a57ff;
      --border:rgba(255,255,255,.08);
      --good:#2bd47d;
      --warn:#ffcc66;
      --bad:#ff5a6a;
      --radius:18px;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Inter,Arial,sans-serif;
      background: radial-gradient(900px 600px at 20% 0%, rgba(90,87,255,.18), transparent 60%),
                  radial-gradient(900px 600px at 90% 20%, rgba(43,212,125,.10), transparent 55%),
                  var(--bg);
      color:var(--text);
      min-height:100vh;
      display:flex;
      justify-content:center;
      padding:18px 14px 26px;
    }
    .wrap{
      width: min(560px, 100%);
    }
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid var(--border);
      border-radius: var(--radius);
      padding:16px;
      box-shadow: 0 12px 40px rgba(0,0,0,.35);
    }
    .top{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:14px;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      font-weight:800;
      font-size:20px;
      letter-spacing:.2px;
    }
    .pill{
      display:flex;
      gap:10px;
      align-items:center;
    }
    select, input, button{
      font: inherit;
    }
    .select{
      background: var(--card2);
      border:1px solid var(--border);
      color: var(--text);
      border-radius: 14px;
      padding:10px 12px;
      outline:none;
      min-width:84px;
    }
    .grid{
      display:grid;
      gap:10px;
    }
    .row2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    @media (max-width:420px){
      .row2{ grid-template-columns:1fr; }
    }
    .field{
      background: var(--card2);
      border:1px solid var(--border);
      border-radius: 16px;
      padding:12px 12px 10px;
    }
    .label{
      color: var(--muted);
      font-size:12px;
      margin-bottom:8px;
    }
    input{
      width:100%;
      border:0;
      outline:none;
      background: transparent;
      color: var(--text);
      font-size:18px;
      padding:2px 2px 4px;
    }
    input::placeholder{ color: rgba(255,255,255,.35); }
    .btn{
      background: var(--accent);
      border:0;
      color:white;
      border-radius: 16px;
      padding:14px 14px;
      font-weight:800;
      font-size:16px;
      cursor:pointer;
      width:100%;
      box-shadow: 0 10px 26px rgba(90,87,255,.35);
      transition: transform .05s ease;
    }
    .btn:active{ transform: translateY(1px); }
    .result{
      margin-top:12px;
      padding:14px 14px;
      border-radius:16px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.03);
      text-align:center;
    }
    .big{
      font-size:20px;
      font-weight:900;
    }
    .small{
      color: var(--muted);
      font-size:12px;
      margin-top:6px;
      line-height:1.35;
    }
    .tabs{
      margin-top:12px;
      display:flex;
      gap:10px;
    }
    .tab{
      flex:1;
      background: var(--card2);
      border:1px solid var(--border);
      color: var(--text);
      border-radius: 14px;
      padding:10px 12px;
      font-weight:800;
      cursor:pointer;
    }
    .tab.active{
      background: rgba(90,87,255,.18);
      border-color: rgba(90,87,255,.45);
    }
    .probox{
      margin-top:10px;
      padding:12px;
      border-radius:16px;
      border:1px dashed rgba(255,255,255,.18);
      background: rgba(255,255,255,.02);
    }
    .hint{
      color: var(--muted);
      font-size:13px;
      line-height:1.35;
      margin:8px 0 0;
    }
    .inline{
      display:flex;
      gap:10px;
      align-items:center;
      margin-top:10px;
    }
    .inline input{
      background: var(--card2);
      border:1px solid var(--border);
      border-radius: 14px;
      padding:10px 12px;
      font-size:14px;
    }
    .mini{
      background: rgba(255,255,255,.08);
      border:1px solid var(--border);
      color: var(--text);
      border-radius: 14px;
      padding:10px 12px;
      font-weight:800;
      cursor:pointer;
      white-space:nowrap;
    }
    .status{
      margin-top:10px;
      font-size:13px;
      font-weight:700;
    }
    .ok{ color: var(--good); }
    .bad{ color: var(--bad); }
    .warn{ color: var(--warn); }
    .roundRow{
      margin-top:10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:10px 12px;
      background: var(--card2);
      border:1px solid var(--border);
      border-radius:14px;
    }
    .toggle{
      display:flex;
      align-items:center;
      gap:10px;
      color: var(--muted);
      font-size:13px;
      font-weight:700;
    }
    .toggle input{ width:auto; }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">
      <div class="top">
        <div class="brand" id="title">üí∏ Tip Splitter</div>
        <div class="pill">
          <select id="lang" class="select">
            <option value="en">EN</option>
            <option value="ru">RU</option>
          </select>
          <select id="currency" class="select">
            <option value="USD">USD $</option>
            <option value="EUR">EUR ‚Ç¨</option>
            <option value="RUB">RUB ‚ÇΩ</option>
            <option value="USDT">USDT ‚ÇÆ</option>
          </select>
        </div>
      </div>

      <div class="tabs">
        <button class="tab active" id="tabBasic"></button>
        <button class="tab" id="tabPro"></button>
      </div>

      <div class="grid" style="margin-top:12px;">
        <div class="field">
          <div class="label" id="lblBill"></div>
          <input id="bill" type="number" inputmode="decimal" placeholder="" value="86" />
        </div>

        <div class="row2">
          <div class="field">
            <div class="label" id="lblPeople"></div>
            <input id="people" type="number" inputmode="numeric" placeholder="" value="3" />
          </div>

          <div class="field">
            <div class="label" id="lblTip"></div>
            <input id="tip" type="number" inputmode="decimal" placeholder="" value="15" />
          </div>
        </div>

        <div class="roundRow" id="roundRow" style="display:none;">
          <div class="toggle">
            <span id="lblRound"></span>
          </div>
          <label class="toggle">
            <input type="checkbox" id="roundUp" />
            <span id="lblRoundSmall"></span>
          </label>
        </div>

        <button class="btn" id="calc"></button>

        <div class="result" id="resultBox" style="display:none;">
          <div class="big" id="resultText"></div>
          <div class="small" id="resultSmall"></div>
        </div>

        <div class="probox" id="proBox" style="display:none;">
          <div style="font-weight:900;" id="proTitle"></div>
          <p class="hint" id="proHint"></p>

          <div class="inline">
            <input id="promo" type="text" placeholder="PROMO-CODE" />
            <button class="mini" id="activate"></button>
            <a class="mini" id="contact" href="https://t.me/xarm0" target="_blank" style="text-decoration:none; display:inline-flex; align-items:center; justify-content:center;">
              @xarm0
            </a>
          </div>

          <div class="status" id="proStatus"></div>
        </div>
      </div>
    </div>
  </div>

<script>
  // ---------- –¢–ï–ö–°–¢–´ (EN/RU) ----------
  const texts = {
    en: {
      title: "üí∏ Tip Splitter",
      tabBasic: "Basic",
      tabPro: "PRO",
      bill: "Bill amount",
      people: "People",
      tip: "Tip (%)",
      round: "Rounding (PRO)",
      roundSmall: "Round up",
      btn: "Calculate",
      each: "Each person pays",
      details: "Total: {total} ‚Ä¢ Tip: {tip} ‚Ä¢ People: {people}",
      proTitle: "PRO unlock",
      proHint: "To enable PRO, enter a promo code. If you don‚Äôt have one ‚Äî tap @xarm0 to get it.",
      activate: "Activate",
      ok: "‚úÖ PRO activated!",
      bad: "‚ùå Invalid code",
      locked: "PRO locked. Enter promo code to unlock rounding."
    },
    ru: {
      title: "üí∏ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —á–∞–µ–≤—ã—Ö",
      tabBasic: "–ë–∞–∑–∞",
      tabPro: "PRO",
      bill: "–°—É–º–º–∞ —Å—á—ë—Ç–∞",
      people: "–ß–µ–ª–æ–≤–µ–∫",
      tip: "–ß–∞–µ–≤—ã–µ (%)",
      round: "–û–∫—Ä—É–≥–ª–µ–Ω–∏–µ (PRO)",
      roundSmall: "–û–∫—Ä—É–≥–ª–∏—Ç—å –≤–≤–µ—Ä—Ö",
      btn: "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å",
      each: "–ö–∞–∂–¥—ã–π –ø–ª–∞—Ç–∏—Ç",
      details: "–ò—Ç–æ–≥–æ: {total} ‚Ä¢ –ß–∞–µ–≤—ã–µ: {tip} ‚Ä¢ –õ—é–¥–µ–π: {people}",
      proTitle: "–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ PRO",
      proHint: "–ß—Ç–æ–±—ã –≤–∫–ª—é—á–∏—Ç—å PRO ‚Äî –≤–≤–µ–¥–∏ –ø—Ä–æ–º–æ–∫–æ–¥. –ù–µ—Ç –ø—Ä–æ–º–æ–∫–æ–¥–∞? –ù–∞–∂–º–∏ @xarm0 –∏ –Ω–∞–ø–∏—à–∏ –º–Ω–µ.",
      activate: "–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å",
      ok: "‚úÖ PRO –≤–∫–ª—é—á—ë–Ω!",
      bad: "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥",
      locked: "PRO –∑–∞–∫—Ä—ã—Ç. –í–≤–µ–¥–∏ –ø—Ä–æ–º–æ–∫–æ–¥, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ."
    }
  };

  // ---------- –ü–†–û–ú–û–ö–û–î–´ (–ø—Ä–∏–º–µ—Ä: 10 —à—Ç). –¢—ã –º–æ–∂–µ—à—å –ø–æ—Ç–æ–º –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Å–≤–æ–∏ 100/200 ----------
  // –í–ê–ñ–ù–û: —ç—Ç–æ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π —Ñ–∞–π–ª, –ø–æ—ç—Ç–æ–º—É "—Å–µ–∫—Ä–µ—Ç–Ω–æ—Å—Ç—å" –∑–¥–µ—Å—å —É—Å–ª–æ–≤–Ω–∞—è.
  // –ù–æ –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏ —à–∞–±–ª–æ–Ω–∞ —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ: —á–µ–ª–æ–≤–µ–∫ –ø–æ–∫—É–ø–∞–µ—Ç —É–¥–æ–±—Å—Ç–≤–æ/—à–∞–±–ª–æ–Ω, –∞ –Ω–µ "–≤–∑–ª–æ–º–æ—Å—Ç–æ–π–∫–æ—Å—Ç—å".
  const VALID_CODES = new Set([
    "TIPPRO-1A2B3C",
    "TIPPRO-4D5E6F",
    "TIPPRO-7G8H9J",
    "TIPPRO-K1L2M3",
    "TIPPRO-N4P5Q6",
    "TIPPRO-R7S8T9",
    "TIPPRO-U1V2W3",
    "TIPPRO-X4Y5Z6",
    "TIPPRO-HELLO1",
    "TIPPRO-HELLO2"
  ]);

  // ---------- –°–û–°–¢–û–Ø–ù–ò–ï ----------
  let lang = "en";
  let mode = "basic";     // basic | pro
  let proEnabled = false;

  const $ = (id) => document.getElementById(id);

  const langSel = $("lang");
  const curSel  = $("currency");
  const tabBasic = $("tabBasic");
  const tabPro = $("tabPro");

  const lblBill = $("lblBill");
  const lblPeople = $("lblPeople");
  const lblTip = $("lblTip");
  const lblRound = $("lblRound");
  const lblRoundSmall = $("lblRoundSmall");

  const bill = $("bill");
  const people = $("people");
  const tip = $("tip");

  const roundRow = $("roundRow");
  const roundUp = $("roundUp");

  const btn = $("calc");
  const resultBox = $("resultBox");
  const resultText = $("resultText");
  const resultSmall = $("resultSmall");

  const proBox = $("proBox");
  const proTitle = $("proTitle");
  const proHint = $("proHint");
  const promo = $("promo");
  const activate = $("activate");
  const proStatus = $("proStatus");

  // ---------- TELEGRAM UI (–µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω–æ –≤–Ω—É—Ç—Ä–∏ Telegram) ----------
  try {
    if (window.Telegram && Telegram.WebApp) {
      Telegram.WebApp.ready();
      Telegram.WebApp.expand();
    }
  } catch (e) {}

  // ---------- –§–û–†–ú–ê–¢ –î–ï–ù–ï–ì ----------
  function symbolFor(code){
    if (code === "USD") return "$";
    if (code === "EUR") return "‚Ç¨";
    if (code === "RUB") return "‚ÇΩ";
    if (code === "USDT") return "‚ÇÆ";
    return "";
  }

  function formatMoney(value, currency){
    // 2 –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    const sym = symbolFor(currency);
    const n = Number.isFinite(value) ? value : 0;

    // –î–ª—è RUB –º–æ–∂–Ω–æ 2 –∑–Ω–∞–∫–∞ –æ—Å—Ç–∞–≤–∏—Ç—å ‚Äî –Ω–æ—Ä–º–∞–ª—å–Ω–æ. –ï—Å–ª–∏ —Ö–æ—á–µ—à—å –±–µ–∑ –∫–æ–ø–µ–µ–∫ ‚Äî —Å–∫–∞–∂–∏.
    const fixed = n.toFixed(2);

    return `${sym}${fixed}`;
  }

  // ---------- –Ø–ó–´–ö ----------
  function applyLanguage(){
    const t = texts[lang];

    $("title").innerText = t.title;

    tabBasic.innerText = t.tabBasic;
    tabPro.innerText = t.tabPro;

    lblBill.innerText = t.bill;
    lblPeople.innerText = t.people;
    lblTip.innerText = t.tip;

    // –í–ê–ñ–ù–û: placeholders ‚Äî —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ "–ø—É—Å—Ç–æ—Ç—ã"
    bill.placeholder = t.bill;
    people.placeholder = t.people;
    tip.placeholder = t.tip;

    lblRound.innerText = t.round;
    lblRoundSmall.innerText = t.roundSmall;

    btn.innerText = t.btn;

    proTitle.innerText = t.proTitle;
    proHint.innerText = t.proHint;
    activate.innerText = t.activate;

    if (!proEnabled && mode === "pro") {
      proStatus.className = "status warn";
      proStatus.innerText = t.locked;
    }
  }

  // ---------- –†–ï–ñ–ò–ú–´ (BASIC/PRO) ----------
  function setMode(next){
    mode = next;

    if (mode === "basic") {
      tabBasic.classList.add("active");
      tabPro.classList.remove("active");
      proBox.style.display = "none";
    } else {
      tabPro.classList.add("active");
      tabBasic.classList.remove("active");
      proBox.style.display = "block";

      if (!proEnabled) {
        proStatus.className = "status warn";
        proStatus.innerText = texts[lang].locked;
      }
    }

    // –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ –≤–∏–¥–Ω–æ —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ PRO –≤–∫–ª—é—á—ë–Ω
    roundRow.style.display = proEnabled ? "flex" : "none";
  }

  // ---------- –†–ê–°–ß–Å–¢ ----------
  function calculate(){
    const currency = curSel.value;
    const b = parseFloat(bill.value);
    const p = parseInt(people.value, 10);
    const t = parseFloat(tip.value);

    if (!Number.isFinite(b) || b <= 0) return showError();
    if (!Number.isFinite(p) || p <= 0) return showError();
    if (!Number.isFinite(t) || t < 0) return showError();

    const tipAmount = b * (t / 100);
    const total = b + tipAmount;
    let each = total / p;

    // PRO: –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ –≤–≤–µ—Ä—Ö –¥–æ —Ü–µ–ª–æ–≥–æ (–¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞)
    if (proEnabled && roundUp.checked) {
      each = Math.ceil(each);
    }

    const sym = symbolFor(currency);

    resultText.innerText = `${texts[lang].each} ${sym}${each.toFixed(2)}`;
    resultSmall.innerText = texts[lang].details
      .replace("{total}", `${sym}${total.toFixed(2)}`)
      .replace("{tip}", `${sym}${tipAmount.toFixed(2)}`)
      .replace("{people}", `${p}`);

    resultBox.style.display = "block";
  }

  function showError(){
    resultText.innerText = "‚Äî";
    resultSmall.innerText = "";
    resultBox.style.display = "block";
  }

  // ---------- –ê–ö–¢–ò–í–ê–¶–ò–Ø –ü–†–û–ú–û ----------
  function activatePro(){
    const code = (promo.value || "").trim().toUpperCase();
    if (!code) return;

    if (VALID_CODES.has(code)) {
      proEnabled = true;

      proStatus.className = "status ok";
      proStatus.innerText = texts[lang].ok;

      // –ø–æ–∫–∞–∑—ã–≤–∞–µ–º PRO-—Ñ—É–Ω–∫—Ü–∏–∏
      roundRow.style.display = "flex";
    } else {
      proStatus.className = "status bad";
      proStatus.innerText = texts[lang].bad;
    }
  }

  // ---------- –°–æ–±—ã—Ç–∏—è ----------
  langSel.addEventListener("change", () => {
    lang = langSel.value;
    applyLanguage();
  });

  tabBasic.addEventListener("click", () => setMode("basic"));
  tabPro.addEventListener("click", () => setMode("pro"));

  btn.addEventListener("click", calculate);
  activate.addEventListener("click", activatePro);

  // Enter –≤ –ø—Ä–æ–º–æ–∫–æ–¥–µ
  promo.addEventListener("keydown", (e) => {
    if (e.key === "Enter") activatePro();
  });

  // ---------- –°—Ç–∞—Ä—Ç ----------
  applyLanguage();
  setMode("basic");
</script>
</body>
</html>
